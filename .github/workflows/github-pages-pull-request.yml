name: Deploy to GitHub Pages on PR

on:
  workflow_dispatch:
  pull_request:
    paths-ignore:
      - ".idea/**"
      - ".vscode/**"
      - "apps/app/**"
      - "docs/**"
      - "scripts/**"
      - "tools/**"
      - "mason.yaml"
      - "**/docs/**"
      - "**/test/**"
      - "**.md"

env:
  PROJECT_DIR: apps/catalog

jobs:
  build:
    runs-on: ubuntu-22.04
    steps:
      # https://github.com/actions/checkout
      - name: Checkout
        uses: actions/checkout@b4ffde65f46336ab88eb53be808477a3936bae11 # v4.1.1

      - name: Setup Application Runtime
        uses: ./.github/actions/setup-application-runtime

      - name: Build web
        run: flutter build web --release --wasm --base-href /${{ github.event.repository.name }}/
        working-directory: ${{ env.PROJECT_DIR }}

    #   # https://github.com/actions/upload-pages-artifact
    #   - name: Upload static files as artifact
    #     id: deployment
    #     uses: actions/upload-pages-artifact@56afc609e74202658d3ffba0e8f6dda462b719fa # v3.0.1
    #     with:
    #       path: ${{ env.PROJECT_DIR }}/build/web
   
          
#   deploy:
#     environment:
#       name: github-pages
#       url: ${{ steps.deployment.outputs.page_url }}
#     runs-on: ubuntu-22.04
#     needs: build
#     steps:
#       # https://github.com/actions/deploy-pages
#       - name: Deploy to GitHub Pages
#         id: deployment
#         uses: actions/deploy-pages@d6db90164ac5ed86f2b6aed7e0febac5b3c0c03e # v4.0.5
